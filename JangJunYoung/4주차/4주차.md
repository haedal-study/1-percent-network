# 4주차

## 기본 네트워크 개념

### 1.허브(L1더미 허브)

허브는 여러대의 컴퓨터를 연결해서 네트워크를 만들어주는 장치로서, **데이터 패킷을 받으면 연결된 모든 장치들에게 모두 보낸다**.모든 장치들이 데이터패킷을 받고 자신에게 온 데이터 패킷인지 확인하고 필요하면 취득한다. 즉 **단순분배를 하는 중계장치**이다.

허브는 위와 같이 모든 연결된 장치에게 패킷을 뿌리기 때무에 자신이 가지고 있는 데이터 전송대역을 분리해서 사용하야 한다. 예를 들어 원래 허브의 데이터 전송속도가 500Mbps라고 하면, 장치가 5대가 연결되어 있는 경우 대역폭은 100Mbps로 나눠지게 된다.

허브는 IP할당 기능은 따로 있지 않고 리피터와 멀티포트의 역할을 한다.

- 리피터:전기적인 신호를 증폭시켜 들어온 데이터를 재전송.LAN의 최대 전송길이도 연장되고, 접속할 수 있는 장비수도 많아지게 된다.
- 멀티포트:한번에 많은 디바이스를 연결 할 수 있는 기능으로 1개의 포트에 한대의 디바이스가 할당된다.

![Untitled](https://github.com/johnny19991006/1-percent-network/assets/79901434/f628366b-1487-4602-a5fc-fce1ad3acc0e)



허브를 이용한 LAN 특징

- 입력 포트를 제외한 나머지 모든 포트로 데이터를 전달하는 플러딩(flooding방식으로 동작)

하지만 위에서 설명했다 싶이 허브는 단순히 분배 중계기에 불과하기에 IP를 할당하는 기능은 없고 단순히 디바이스 수에 따라 데이터 전송 대역을 분리하는 역할 만 한다. 예를들어 10Mbps를 제공하는 이더텟에 8포트 허브로 PC를 연결 시킬 경우 각 PC는 1.25Mbps의 대역폭만을 사용하게 되는 것이다.

결과적으로 허블 연결될 네트워크에서 하나의 디바이스에서 전송된 데이터 프레임을 허브로 연결된 모든 디바이스에게 전부 전송하는 플러딩(flooding)이 발생한다. 결과적으로 충돌이 발생하여 하나의 허브에는 많은 디바이스를 연결할 수 없다. 동일하나 이유로 보안성 또한 떨어진다. 그래서 현재는 잘 쓰이지 않는 구시대 장비라고 볼 수 있다.

### 2.스위치(L2스위치 허브)

스위치는 연결된 장치들의 IP와 MAC주소를 모두 테이블 형태로 가지고, **원하는 목적지에 데이터 패킷을 전송하는 장치**이다. 허브와 달리 스위치는 무작정 데이터 패킷을 뿌리는 것이 아니라, IP와 MAC주소를 기반으로 필요한 장치에게만 데이터 패킷을 전송해 준다.

예를 들어 87.90.20.2:5000라는 IP와 Port로 요청이 들어왔다고 가정해보자. 이 경우 스위치는 해당 요청을 받아서 테이블에서 요청된 IP와 Port에 해당하는 MAC주소를 찾고, 해당 MAC주소를 가진 장치에게 데이터 패킷을 전송해준다. 만약 IP주소와 Port에 일치하는 MAC주소가 테이블에 존재하지 않는 경우에는 , 허브처럼 모든 장치들에게 다 데이터 패킷을 뿌려서(포워딩)테이블을 갱신한다.


![Untitled 1](https://github.com/johnny19991006/1-percent-network/assets/79901434/59b17d5c-278e-4866-8e10-d33835692b81)


스위치를 이용한 LAN특징

- 스위치의 각 포트는 하나의 LAN세그먼트(segment)를 구축
- LAN카드 번호 (MAC주소)를 이용하여 해당되는 포트로만 데이터를 전달

허브에서 언급한 예제와 동일한 전송속도를 스위치가 가지고 있다고 하면, 장치가 5대 연결되어 있다고 하더라도 하나의 장치에 데이터를 전송하기 대문에 대역폭이 500Mbps로 유지된다.

### 3.라우터(L3)

라우터는 LAN(Local Area Network:근거리 통신망)을 연결해주는 장치로써, 데이터를 전송할때 **최종목적지에게 가기 위하여 거쳐야 하는 많은 경로들 중에 적절한 통신 경로를 결정하기 위하여 한 통신망에서 다른 통신망으로 데이터 패킷을 전송하는 장치**이다.


![Untitled 2](https://github.com/johnny19991006/1-percent-network/assets/79901434/b2b3173d-ccfd-44ee-97e7-84d81c7e2cb5)


라우터를 이용한 네트워크 특징

- 라우터의 각 포트는 하나의 독립적인 네트워크 구축가능

주로 web에서 우리가 서비스를 사용하기 위해서는 구글/네이버와 같은 서비스 제공자의 주소에 접속을 필요로 한다. 이런 경우에 서버가 내 IP와는 다른 IP를 가지고 있는 경우가 많다. 이런 경우 먼저 우리가 흔히 알고 있는 ‘www.naver.com’와 같은 도메인을 통하여 접속을 하면, 도메인 서버를 통하여 IP를 얻을 수 있다.

이 IP를 이용하여 요청을 보내면 라우터에서는 ‘다음은 여기 라우터로 가야 한다’라고 판단하고 데이터 패킷을 다른 라우터에게 전송하여 준다. 이런 과정을 여러번 진행하면서 수많은 라우터들을 거치고, 최종목적지인 네이터로 도착하게 되는 것이다.

라우터에서의 딜레이는 [Delay&loss in packet-switched networks](https://www.notion.so/Delay-loss-in-packet-switched-networks-e3f4014be41d4eff8f0d4c57671c7020?pvs=21) 에서 확인 할 수 있다.

### 4.공유기

ISP(Internet Service Provider)업체에서는 IP를 제공하고, 소비자는 해당IP를 구매해서 사용할 수 있다. 집이나 회사에서 해당 IP를 통하여 여러 장치들을 사용하고 싶을 경우가 있다. 이런 경우에 공유기를 사용하여 여러 노트북과 컴퓨터와 같은 다양한 장치들을 인터넷에 연결 할 수 있다.

ISP에서 제공해주는 IP는 외부IP라고 하고, 공유기를 통해서 내부의 컴퓨터들이 사용할 수 있는 IP는 내부IP라고 한다. 192.168.0.xxx와 같은 형태를 띄고 있는 경우가 많다. 

### 5.인터넷,LAN,MAN,WAN

인터넷(Internet)은 Inter-networking(인터넷들의 연결)의 약자로, 쉽게 표현하면 라우터들의 모임이다. 여러가지 LAN이 모여서 거대한 네트워크가 바로 인터넷이고 이것을 WAN이라고 한다.

- LAN(Local Area Network):근거리 통신만.집,회사정도의 규모

![Untitled 3](https://github.com/johnny19991006/1-percent-network/assets/79901434/f83e6abf-9cd6-4bbd-a60e-5f013c94a44a)


LAN선 구축 후 Ping테스트한 결과

- MAN(Metropolitan Area Network):도시 지역 통신망. 도시 하나정도의 규모
- WAN(Wide Area Network):광역 통신망.MAN이 모여서 만들어진다

![Untitled 4](https://github.com/johnny19991006/1-percent-network/assets/79901434/b4632f4d-49f9-45f7-83d5-21daefee1597)


WA선 구축 후 Ping테스트 한 결과

### 간단히 정리

1. 허브: 리피터와 멀티포트 기능. 멀티포트는 단순히 분배 중계기 역할만 한다.
2. 스위치: 허브의 단점을 해결. 특정 목표로만 전달 할 수 있다.
3. 라우터: 라우팅 알고리즘으로 가장 적절한 통신경로를 찾아서 다른 통신망으로 연결해주는 장비이다.
4. 공유기: 라우터의 많은 기능중 NAT기능을 특화시켜 만든 저렴한 장비. 사설 IP로 인터넷 사용이 가능하게 하면 허브 기능이 지원된다.

### IP주소의 종류

![Untitled 5](https://github.com/johnny19991006/1-percent-network/assets/79901434/bb4d04f8-ab08-4024-9789-56b39362ab5a)


예를들어 192.168.0.1/24인 경우 네트워크가 24비트이기에 클래스c임을 알 수 있다.

### 서브넷 마스크

먼저 서브넷은 IP주소에서 네트워크 영역을 부분적으로 나눈 부분 네트워크를 뜻한다. 하나의 네트워크는 **여러개의 작은 네트워크로 분리할 수 있는데, 이때 분리된 작은 네트워크를 서브넷** 이라고 한다.

![Untitled 6](https://github.com/johnny19991006/1-percent-network/assets/79901434/3deab2d7-e52c-483d-9f06-8e688ff66aa8)


위와 같이 **네트워크 관리자가 네트워크 성능을 향상시키기 위해, 자원을 효율적으로 분리하는 과정**을 서브넷팅이라고 한다.(관리하기 어려운 브로드캐스팅에 대한 문제를 해결하는 방)

서브넷 마스크는 32비트 IP주소중에 **네트워크 비트들의 위치를 알려주는 비트열**이다. 기본적으로 1과 0으로 이루어져 있고 1이 연속으로 나와야 한다.

예를들어 IP주소가 192.168.0.1/24 서브넷 마스크가 255.255.255.0 인 주소에서  10진수를 2진수로 바꾸어 보면 11111111.11111111.11111111.00000000이다.

IP뒤에 /24라는 표현이 1이 24개 있다는 뜻이다.(1은 네트워크 영역, 0은 호스트 영역으로 나타낸다.)

반대의 개념으로 규모가 작은 네트워크들을 합하여 새로운 커다란 네트워크를 만드는 기술인 **수퍼넷** 또한 존재한다.

### 게이트웨이

게이트웨이가 없다면 IP주소와 서브넷마스크만 있다면 자신이 속한 로컬 네트워크에서만 통신이 가능하다. 즉 외부 네트워크및 인터넷을 사용할 수 없게 된다. 인터넷 등 다른 네트워크로 나가기 위해서는 게이트웨이(라우터등)가 있어야 하고 IP주소,서브넷마스크,게이트웨이 주소까지 정확하게 설정해야 하기 때문이다.

![Untitled 7](https://github.com/johnny19991006/1-percent-network/assets/79901434/d1d3e2a2-cc70-4698-a12c-b1e7b28fdb45)


일반적으로 게이트웨이 주소는 네트워크에 할당된 host의 ip주소 중 끝자리만 다른 형태이다. 대부분 1로 지정하며 이와 같이 표시할 수 있다. 위 게이트웨이 주소가 정확하지 않으면 외부 네트워크 및 인터넷 연결이 불가능 하다.

여기서 라우터는 LAN과 WAN을 연결할때 많이 사용되며, 게이트웨이는 프로토콜이 다른 네트워크 장비를 연결 할때 주로 사용된다.

### dhcp

DHCP란 호스트의 IP줏와 각종 TCP/IP프로토콜의 기본설정을 클라이언트에게 자동적으로 제공해주는 프로토콜을 말한다. DHCP에 대한 표준은 RFC문서에 정의 되어 있으며, DHCP는 네트워크에 사용되는 IP주소를 DHCP서버가 중앙집중식으로 관리하는 클라이언트/서버 모델을 사용하게 된다. DHCP지원 클라이언트는 네트워크 부팅과정에서 DHCP서버에 IP주소를 요청하고 이를 얻을 수 있다.

### 패킷이란?

네트워크에서 출발지와 목적지 간에 라우팅 되는 데이터의 단위이다. 즉 정보를 보낼때 특정 형태를 맞추어 보내 컴퓨터 간에 데이터를 주고 받을 때 네트워크를 통해 전송되는 데이터 조각이다.

### 패킷의 구성요소

![Untitled 8](https://github.com/johnny19991006/1-percent-network/assets/79901434/3bde4df8-d84f-4f00-8f7e-a94bf9959406)


패킷은 헤더, 페이로드,트레일러 세부분으로 구성된다. 

- 헤더

각 패킷에는 두개의 식별번호가 있는데 첫번째는 정보조각의 분할된 패킷 수를 나타내고, 두번째는 완전한 정보의 일부로서 개별 패킷의 위치를 나타낸다.

- 소스주소: 패킷을 네트워크로 보내는 장치의 IP주소
- 대상주소: 패킷이 전송되는 IP주소
- 버젼: 사용중인 IP버젼을 식별하는데 사용
- TTL(Time to Live):패킷이 네트워크에 남아있을 수 있는 생존시간으로 이 패킷을 처리하는 각 라우터가 카운트를 하나이상 감소시킨다.
- 프로토콜:IP패킷의 데이터 부분이 전달되는 전송 계층 프로토콜.TCP/UDP(ping테스트를 통해 확인이 가능하다)
- 헤더 체크섬: 헤더가 전송되는 도중 변조되거나 깨지는 경우를 확인하기 위해 사용된다.
- 페이로드
    
    패킷에 의해 전송되는 실제 데이터를 나타낸 것으로 데이터라고도 한다. 페이로드는 헤더 정보가 목적지에 도달할때 패킷에서 제거되므로 소스 및 목적지에서 수신하는 유일한 데이터 이다.
    
- 트레일러
    
    패킷 트레일러의 내용은 각 네트어크 유형에 따라 다르며 일반적으로 트레일러에는 수신 장치에 패킷 끝까지 도달 했음을 알리는 몇 비트와 컴퓨터가 모든 패킷이 완전히 수신되었는지 확인할수 있는 CRC(Cycle Redundancy Check)가 포함되어 있다.
    

네트워크 패킷의 흐름은 [Encapsulation&Decapsulation](https://www.notion.so/Encapsulation-Decapsulation-615340f7de3244c393a3f9a7f9087662?pvs=21) 

에서 확인 할 수 있다.

### ARP로 수신처 라우터의 MAC주소 조사

ARP는 Address Resolution Protocol의 약자로 IP주소를 MAC주소와 매칭시키기 위한 프로토콜이다. ARP를 사용하는 이유는 로컬 네트워크(LAN)에서 단말과 단말간의 통신을 하기 위해서는 IP주소와 함께 MAC주소를 이용하게 되는데, IP주소를 MAC Address와 매칭하여 목적지 IP의 단말이 소유한 MAC주소를 향해 제대로 찾아내기 위함이다. 
패킷을 송신할때 우선 ARP캐시를 조사하여 거기에 상대의 MAC주소가 저장되어 있으면 ARP를 조회하지 않고 ARP캐시에 보존되어 있는 값을 사용한다.
ARP캐시는 시간이 지나면 삭제된다.

### IP패킷을 전기나 빛의 신호로 변환하여 송신

LAN어댑터는 전원을 공급하면 즉시 사용할 수 있는 것이 아니라 다른 하드웨어와 마찬가지로 초기화 작업이 필요하다.
LAN어댑터의 ROM에는 전세계적으로 중복되지 않도록 일원화 해서 관리하는 MAC주소를 제조할때 기록하므로 이것을 읽어와서 MAC회로에 설정하는 것이다.

### 패킷에 3개의 제어용 데이터를 추가

lAN드라이버는 IP담당 부분에서 패킷을 받으면 그것을 LAN어댑터의 버퍼메모리에 복사한다.

### 허브를 향해 패킷을 송신

리피터 허브를 사용했을때의 반이중 모드와 스위칭 허브를 사용했을때의 전이중 모드가 있다.

전이중(Full-duplex)방식: Sender와 Receiver사이의 통신은 **‘동시에’** 일어난다. Sender와 Receiver는 동시에 정보를 전송하고 수신할 수 있다.

반이중(Half-duples)방식:Sender와 Receiver 사이의 통신은 한번에 하나씩만 이지만 **‘쌍방향’**으로 이루어 진다.

## UDP프로코톨을 이용한 송신 동작

### UDP세그먼트 구조

![Untitled 9](https://github.com/johnny19991006/1-percent-network/assets/79901434/047aa92c-6d2f-48e6-94ea-5da8960ecd4a)

포트번호:mux와 demux를 구현하기 위해 사용

목적지 호스트가 목적지 중단 시스템에서 동작하는(역다중화 기능을 수행하는)정확한 프로세스에게 어플리케이션 데이터를 넘기게 해 준다. 할당하지 않은 경우 운영체제가 할당해 준다.

검사합:세그먼트에 오류가 있는지 없는지 검출한다. 알고리즘이 단순하고, 오류 검ㅊㄹ 능력이 뛰어나지만 만약 워드의 순서가 뒤섞이거나 우연찮게 다른 워드의 같은 비트가 서로 다르게 바뀌었을 경우에는 검사합이 0이 되어 오류 검출이 불가능해진다는 단점이 있다.

### 수정 송신이 필요없는 데이터의 송신은 UDP가 효율적

TCP의 동작은 상당히 복잡하기만 데이터를 확실하면서도 효율적으로 전달하기 위함이다.
DNS서버에 대한 조회 등 제어용으로 실행하는 정보교환은 한개의 패킷으로 끝나는 경우가 많으면 TCP가 아니라 UDP를 사용한다.
UDP에는TCP와 같은 수신확인이나 윈도우가 없어서 데이터 송 수신 전에 제어정보를 주고받을 필요가 없고, 접속이나 연결 끊기 단계가 없다.
애플리케이션에서 송신 데이터를 받으면 여기에 UDP헤더를 부가하고 이것을 IP에 의뢰하여 송신하기만 한다.

수신또한 IP헤더에 기록되어 있는 수신처 IP주소와 송신처 IP주소, 그리고 UDP헤더에 기록되어 있는 수신처 포트번호와 송신처 포트번호라는 네 항목만 있으면 된다.

### UDP 서비스

음성이나 영상의 데이터를 보낼때도 UDP를 사용한다. 음성이나 영상 데이터는 결정된 시간안에 데이터를 건네주어야 한다.
음성이나 영상에는 데이터가 다소 없어져도 치명적인 문제가 되지 않는 성질이 있기 때문이다.

사용 예로는 다음과 같다.

- 비연결성 전송 서비스
    
    세션을 성립하지 않고 전송, 즉 연결설정에 대한 지연시간은 없지만, 전송에 대한 신뢰성을 없다.
    
- 데이터그램 실시간 전송 서비스
    
    프로세스 간 빠른 요청과 응답이 가능하며, 전송속도에 제한이 없다. 또 헤더가 매우 단순하여 캡슐화와 역캡슐화에 많은 리소스가 사용되지 않는다.
    
- 멀티캐스트 서비스
    
    목적지 IP주소에 멀티캐스트 주소를 사용하여 다수의 호스트에 데이터그램을 전송할 수 있다.
    

출처:

1퍼센트 네트워크

하향식 네트워크

강승찬p 인터네트워킹

설순욱p 데이터통신

이재오p 컴퓨터 네트워크

최선문p UDP

[https://melonicedlatte.com/network/2019/12/21/154500.html](https://melonicedlatte.com/network/2019/12/21/154500.html)

[https://velog.io/@ckstn0777/네트워크-허브-스위치-라우터-공유기](https://velog.io/@ckstn0777/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%ED%97%88%EB%B8%8C-%EC%8A%A4%EC%9C%84%EC%B9%98-%EB%9D%BC%EC%9A%B0%ED%84%B0-%EA%B3%B5%EC%9C%A0%EA%B8%B0)

[https://limkydev.tistory.com/166](https://limkydev.tistory.com/166)

[https://information.koreainfoguide.com/entry/네트워크-용어-게이트웨이-Gateway-게이트웨이와-라우터-차이점](https://information.koreainfoguide.com/entry/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9A%A9%EC%96%B4-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4-Gateway-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4%EC%99%80-%EB%9D%BC%EC%9A%B0%ED%84%B0-%EC%B0%A8%EC%9D%B4%EC%A0%90)

[https://devmoony.tistory.com/183](https://devmoony.tistory.com/183)
